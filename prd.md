# 图片字幕生成器 - 产品需求文档 (PRD)

## 1. 项目概述

### 1.1 项目名称
图片字幕生成器

### 1.2 项目目标
开发一个简单易用的在线网页工具，允许用户上传自己的图片，并为图片底部添加多行带有自定义样式的字幕。最终用户可以预览并下载生成的图片。

---

## 2. 功能需求

### 2.1 核心功能列表
1.  **图片上传**：用户可以选择并上传本地图片文件。
2.  **字幕文本输入**：用户可以输入多行文字作为字幕。
3.  **字幕样式配置**：用户可以自定义字幕的各种样式，包括：
    *   每行字幕的背景高度。
    *   字体大小。
    *   字体颜色。
    *   字体轮廓（描边）颜色。
4.  **实时预览**：在图片上实时生成并展示字幕效果。
5.  **图片生成与保存**：用户可以生成最终的图片，并将其保存到本地。

### 2.2 功能详述

#### 2.2.1 图片上传
- **控件**：一个“选择文件”按钮。
- **行为**：
    - 点击后，应弹出系统文件选择对话框。
    - 用户可以选择一张图片（如 .png, .jpg, .jpeg, .gif 等格式）。
    - 选择后，按钮旁边应显示已选中的文件名。
    - 上传的图片将作为后续字幕添加的基础。

#### 2.2.2 字幕文本输入
- **控件**：一个多行文本输入框（`<textarea>`）。
- **行为**：
    - 用户可以在此框内输入或粘贴文本。
    - 文本框中的每一行都将被视为图片上的一行独立字幕。

#### 2.2.3 字幕样式配置
- **字幕高度 (px)**：
    - **控件**: 数字输入框。
    - **功能**: 定义每一行字幕背景矩形的高度（单位：像素）。
- **字体大小 (px)**：
    - **控件**: 数字输入框。
    - **功能**: 定义字幕文字的大小（单位：像素）。
- **字体颜色**：
    - **控件**: 颜色选择器。
    - **功能**: 定义字幕文字的颜色。
- **轮廓颜色**：
    - **控件**: 颜色选择器。
    - **功能**: 定义字幕文字的描边颜色。

#### 2.2.4 图像生成与预览
- **控件**：一个“生成字幕图片”按钮和一个用于展示结果的图片预览区域。
- **行为**：
    - 点击“生成字幕图片”按钮后，系统将根据当前配置（上传的图片、字幕文本、样式配置）在预览区生成结果图。
    - 字幕应渲染在图片的底部。
    - **关键效果**：每一行字幕都拥有自己独立的、半透明的黑色背景。这些背景矩形宽度与图片宽度一致，高度由“字幕高度”参数决定，从而在视觉上形成清晰的“切割感”。
    - 字幕文字水平居中显示在各自的背景条上。
    - 文字应应用用户选择的字体大小、颜色和轮廓颜色。

#### 2.2.5 图像保存
- **控件**：一个“保存图片”按钮。
- **行为**：
    - 点击后，应触发浏览器下载功能，将预览区域中生成的图片保存为文件（如 `generated_image.png`）。

---

## 3. 界面布局 (UI Layout)

页面从上到下应大致分为三个区域：

1.  **配置区 (Top Area)**:
    - 标题：“图片字幕生成器”
    - 文件选择器
    - 一系列样式配置输入框（字幕高度、字体大小、颜色选择器等）
    - 字幕内容文本输入框

2.  **操作区 (Middle Area)**:
    - “生成字幕图片”按钮
    - “保存图片”按钮

3.  **预览区 (Bottom Area)**:
    - 用于显示添加了字幕后的最终图片。

---

## 4. 技术要点提示

- **图像处理**: 建议使用前端 `Canvas` API 来实现。
    1.  将用户上传的图片绘制到 Canvas 上。
    2.  根据“字幕高度”和行数，在 Canvas 底部绘制相应数量的半透明背景矩形。
    3.  设置 `ctx.font`, `ctx.fillStyle`, `ctx.strokeStyle`, `ctx.lineWidth` 等属性来配置字体样式。
    4.  使用 `ctx.fillText()` 和 `ctx.strokeText()` 在每个背景矩形上绘制居中的文字。
- **图片保存**: 可以使用 `canvas.toDataURL()` 方法将 Canvas 内容转换为图片数据，然后创建一个 `<a>` 标签并模拟点击来实现下载。
